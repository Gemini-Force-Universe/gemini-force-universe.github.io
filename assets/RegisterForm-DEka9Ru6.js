import{W as q,d as S,a as f,o as g,b as T,w as r,f as a,u as e,E as N,B as k,N as be,O as we,U as ye,p as Ce,r as R,s as ke,c as A,v as $,e as t,F as P,y as j,x,I as ee,J as Fe,z as se,C as Ae,A as Te}from"./index-pTNjcZjp.js";import{d as Pe,z as Ie,_ as I,a as V,c as W,b as te}from"./FormMessage.vue_vue_type_script_setup_true_lang-DRt1eSRi.js";import{_ as H,b as Ve,a as D}from"./Input.vue_vue_type_script_setup_true_lang-jLdNSdpc.js";import{x as ae,k as Se,O as Be,C as Ee,B as Z,b as re,w as Re}from"./index-B58lrkWd.js";import{c as O}from"./utils-DnNDQBbQ.js";import{S as $e}from"./Spinner-MXSLBe5O.js";import{u as je}from"./auth-DCUkzX9t.js";/**
 * @license lucide-vue-next v0.429.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=d=>d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.429.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var z={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.429.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=({size:d,strokeWidth:u=2,absoluteStrokeWidth:n,color:s,iconNode:v,name:c,class:b,..._},{slots:F})=>q("svg",{...z,width:d||z.width,height:d||z.height,stroke:s||z.stroke,"stroke-width":n?Number(u)*24/Number(d):u,class:["lucide",`lucide-${He(c??"icon")}`],..._},[...v.map(w=>q(...w)),...F.default?[F.default()]:[]]);/**
 * @license lucide-vue-next v0.429.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=(d,u)=>(n,{slots:s})=>q(ze,{...n,iconNode:u,name:d},s);/**
 * @license lucide-vue-next v0.429.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=oe("CheckIcon",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.429.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=oe("DotIcon",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]),Le=S({__name:"Checkbox",props:{defaultChecked:{type:Boolean},checked:{type:[Boolean,String]},disabled:{type:Boolean},required:{type:Boolean},name:{},value:{},id:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:checked"],setup(d,{emit:u}){const n=d,s=u,v=f(()=>{const{class:b,..._}=n;return _}),c=ae(v,s);return(b,_)=>(g(),T(e(Be),k(e(c),{class:e(O)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n.class)}),{default:r(()=>[a(e(Se),{class:"flex h-full w-full items-center justify-center text-current"},{default:r(()=>[N(b.$slots,"default",{},()=>[a(e(Ne),{class:"h-4 w-4"})])]),_:3})]),_:3},16,["class"]))}}),Ue=S({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},name:{},disabled:{type:Boolean},required:{type:Boolean},id:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","complete"],setup(d,{emit:u}){const n=d,s=u,v=f(()=>{const{class:b,..._}=n;return _}),c=ae(v,s);return(b,_)=>(g(),T(e(Ee),k(e(c),{class:e(O)("flex gap-2 items-center",n.class)}),{default:r(()=>[N(b.$slots,"default")]),_:3},16,["class"]))}}),Me=S({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(d){const u=d,n=f(()=>{const{class:v,...c}=u;return c}),s=Z(n);return(v,c)=>(g(),T(e(re),k(e(s),{class:e(O)("flex items-center",u.class)}),{default:r(()=>[N(v.$slots,"default")]),_:3},16,["class"]))}}),We=S({__name:"PinInputSeparator",props:{asChild:{type:Boolean},as:{}},setup(d){const n=Z(d);return(s,v)=>(g(),T(e(re),be(we(e(n))),{default:r(()=>[N(s.$slots,"default",{},()=>[a(e(Oe))])]),_:3},16))}}),De=S({__name:"PinInputInput",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(d){const u=d,n=f(()=>{const{class:v,...c}=u;return c}),s=Z(n);return(v,c)=>(g(),T(e(Re),k(e(s),{class:e(O)("relative text-center focus:outline-none focus:ring-2 focus:ring-ring focus:relative focus:z-10 flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",u.class)}),null,16,["class"]))}}),qe={key:0,class:"z-50 absolute left-0 top-0 flex items-center justify-center w-full h-full bg-background/80 backdrop-blur-sm"},Ze=t("div",{class:"grid gap-2 text-center"},[t("h1",{class:"text-2xl font-bold"},"Qual é o seu e-mail?"),t("p",{class:"text-sm text-balance text-muted-foreground"}," Não se preocupe, nós cuidamos bem dele. ")],-1),Ge={class:"flex flex-col items-center justify-center gap-4"},Je={class:"flex items-center space-x-4"},Ke=t("div",{class:"grid gap-2 text-center"},[t("h1",{class:"text-2xl font-bold"},"Cheque seu e-mail"),t("p",{class:"text-sm text-muted-foreground"}," Enviamos um código para confirmar que ele é seu. ")],-1),Qe={class:"flex flex-col items-center justify-center gap-4"},Xe={key:0,class:"text-center text-sm text-red-500"},Ye={key:1,class:"text-center text-sm text-green-500"},es={key:2,class:"mt-3 text-sm text-center text-balance"},ss=t("div",{class:"grid gap-2 text-center"},[t("h1",{class:"text-2xl font-bold"},"Crie um Apelido"),t("p",{class:"text-sm text-balance text-muted-foreground"}," Ele será utilizado para acessar a sua conta. ")],-1),ts={class:"flex flex-col items-center justify-center gap-4"},as=t("div",{class:"grid gap-2 text-center"},[t("h1",{class:"text-2xl font-bold"},"Crie uma Senha"),t("p",{class:"text-sm text-balance text-muted-foreground"}," A senha deve ser forte e segura. ")],-1),rs={class:"flex flex-col items-center justify-center gap-8"},os={class:"flex flex-col gap-2 text-xs"},ls={class:"flex items-start gap-2"},ns=t("span",null,'A senha deve ser ao menos "razoável".',-1),is={class:"flex items-start gap-2"},ds=t("span",null,"Deve ter no mínimo 8 caracteres.",-1),cs={class:"flex items-start gap-2"},us=t("span",null," Deve ter ao menos dois dos seguintes itens: letra, número, símbolo. ",-1),ms=Te('<div class="grid gap-2 text-center"><h1 class="text-2xl font-bold">Só mais uma coisa...</h1><p class="text-sm text-muted-foreground"> Temos algumas regras para manter a ordem por aqui. </p></div><div class="flex flex-col items-center justify-center gap-4"><span class="text-sm text-center text-balance"> Ao continuar, você confirma estar de acordo com os nossos </span><a href="/documents/gfu_servico.pdf" target="_blank" class="underline text-nowrap text-primary-foreground"> Termos de Serviço </a><span class="text-sm text-balance">e também com a nossa</span><a href="/documents/gfu_privacidade.pdf" target="_blank" class="underline text-nowrap"> Política de Privacidade </a><span class="text-sm text-center text-balance"> Além disso, você afirma ter 14 anos de idade ou mais. </span></div>',2),ps=[ms],fs=t("div",{class:"grid gap-2 text-center"},[t("h1",{class:"text-2xl font-bold"},"Calma lá..."),t("p",{class:"text-sm text-muted-foreground"}," Robôs não são bem-vindos por aqui. (Só ciber-humanos!) ")],-1),gs={class:"flex flex-col items-center justify-center gap-4"},vs={class:"flex items-center justify-center gap-6 w-full"},hs=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[t("path",{"fill-rule":"evenodd",d:"M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})],-1),xs=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[t("path",{fillRule:"evenodd",d:"M12.97 3.97a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06l6.22-6.22H3a.75.75 0 0 1 0-1.5h16.19l-6.22-6.22a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})],-1),As=S({__name:"RegisterForm",setup(d){const u=["Muito fraca","Fraca","Razoável","Forte","Muito forte"],n=ye(),s=je(),{handleSubmit:v,isFieldValid:c,validateField:b,setFieldValue:_,setFieldError:F}=Ce({initialValues:{username:s.registerForm.username,email:s.registerForm.email,otp:[],password:s.registerForm.password,recaptcha:""},validationSchema:Pe}),w=R(0),L=R(!1),G=R(!1),B=R(""),le=f(()=>s.registerForm.isLoading),i=f(()=>s.registerForm.step),ne=f(()=>s.registerForm.hasAgreedToContact),ie=f(()=>s.registerForm.hasAgreedToTerms),y=f(()=>s.registerForm.password===""?0:Ie(s.registerForm.password).score),de=f(()=>u[y.value]),J=f(()=>y.value>=2),K=f(()=>s.registerForm.password.length>=8),Q=f(()=>{const o=s.registerForm.password,l=/[a-zA-Z]/.test(o),m=/[0-9]/.test(o),p=/[^a-zA-Z0-9]/.test(o);return[l,m,p].filter(Boolean).length>=2}),X=f(()=>c("password")&&J&&K.value&&Q.value),U=f(()=>B.value!==""&&B.value===s.registerForm.password),Y=f(()=>i.value===1?c("email")&&ne.value:i.value===2?!1:i.value===3?c("username"):i.value===4?X.value&&U.value:i.value===5?ie.value:i.value===6?c("recaptcha"):!1),ce=async()=>{if(n===void 0){console.error("Failed to load reCAPTCHA.");return}await n.recaptchaLoaded();const o=await n.executeRecaptcha("register");s.createRegistrationSession(o)},ue=()=>{if(i.value===3){s.registerForm.step=1,h();return}s.registerForm.step-=1,h()},me=async o=>{if(o.preventDefault(),!!Y.value){switch(i.value){case 1:const l=await s.checkEmailAvailability();if(l.isValid){if(!l.isAvailable){F("email","Este e-mail já está em uso."),h();return}}else{F("email","Este e-mail é inválido."),h();return}const m=await s.sendEmailOTP();m.wasAlreadyVerified?(s.registerForm.step+=2,h()):s.registerForm.step+=1,s.registerForm.otp=[],M(m.waitTime),E(!1);break;case 2:break;case 3:const p=await s.checkUsernameAvailability();if(p.isValid){if(!p.isAvailable){F("username","Este apelido não está disponível."),h();return}}else{F("username","Este apelido já está em uso."),h();return}s.registerForm.step+=1;break;case 4:case 5:s.registerForm.step+=1;break;default:v(C=>{s.createUser(C.recaptcha)})();break}h()}},pe=async()=>{const o=await s.resendEmailOTP();if(o.isStillFresh){M(o.waitTime);return}M(o.waitTime),E(!1),h(),L.value=!0,setTimeout(()=>{L.value=!1},5e3)},E=o=>{G.value=o,o&&(s.registerForm.otp=[],h())},M=o=>{if(w.value==0){w.value=o;const l=setInterval(()=>{w.value-=1,w.value<=0&&clearInterval(l)},1e3)}else w.value=o},fe=async o=>{if(!await s.validateEmailOTP(o.join(""))){E(!0);return}E(!1),s.registerForm.step+=1,h()},ge=o=>{console.log("ReCAPTCHA widget ID:",o)},ve=()=>{console.error("ReCAPTCHA widget error."),_("recaptcha","")},he=()=>{console.log("ReCAPTCHA widget expired."),_("recaptcha","")},xe=o=>{console.log("ReCAPTCHA widget response received."),_("recaptcha",o)},_e=()=>{s.setIsRegistering(!1)},h=()=>{setTimeout(()=>{i.value===1?document.getElementById("email").focus():i.value===2?document.getElementById("otp-0").focus():i.value===3?document.getElementById("username").focus():i.value===4&&document.getElementById("password").focus()})};return ke(()=>{ce(),s.registerForm.username!=""&&b("username"),s.registerForm.email!=""&&b("email"),s.registerForm.password!=""&&b("password"),h()}),(o,l)=>(g(),A("form",{class:"flex flex-col items-center justify-center gap-4 w-full",novalidate:"",onSubmit:me},[le.value?(g(),A("div",qe,[a($e)])):$("",!0),t("div",{class:x(["grid gap-6 w-full max-w-[350px]",{hidden:i.value!==1}])},[Ze,t("div",Ge,[a(e(P),{name:"email",label:"e-mail"},{default:r(({componentField:m})=>[a(e(I),{class:"w-full"},{default:r(()=>[a(e(V),null,{default:r(()=>[a(e(H),k({type:"email",class:{"border-2 border-red-500":!e(c)("email")},id:"email",placeholder:"exemplo@email.com",autofocus:""},m,{modelValue:e(s).registerForm.email,"onUpdate:modelValue":l[0]||(l[0]=p=>e(s).registerForm.email=p)}),null,16,["class","modelValue"])]),_:2},1024),a(e(W),{class:"text-red-500"})]),_:2},1024)]),_:1}),t("div",Je,[a(e(Le),{id:"contact-agreement",checked:e(s).registerForm.hasAgreedToContact,"onUpdate:checked":l[1]||(l[1]=m=>e(s).registerForm.hasAgreedToContact=m)},null,8,["checked"]),a(e(Ve),{for:"contact-agreement",class:"text-sm cursor-pointer"},{default:r(()=>[j(" Sim, eu permito que a GFU me envie informações sobre atualizações e ofertas por e-mail. ")]),_:1})])])],2),t("div",{class:x(["grid gap-6 w-full max-w-[350px]",{hidden:i.value!==2}])},[Ke,t("div",Qe,[a(e(P),{name:"otp",label:"OTP"},{default:r(({componentField:m})=>[a(e(I),{class:"w-full"},{default:r(()=>[a(e(V),null,{default:r(()=>[a(e(Ue),k({otp:"",type:"number",class:"flex gap-2 items-center justify-center",id:"otp",placeholder:"○"},m,{modelValue:e(s).registerForm.otp,"onUpdate:modelValue":l[2]||(l[2]=p=>e(s).registerForm.otp=p),onComplete:fe}),{default:r(()=>[a(e(Me),null,{default:r(()=>[(g(),A(ee,null,Fe(6,(p,C)=>(g(),A(ee,{key:p},[a(e(De),{id:`otp-${C}`,class:x(["font-bold bg-background",{"rounded-l-md":C===0||C===3,"rounded-r-md":C===2||C===5}]),index:C},null,8,["id","class","index"]),C===2?(g(),T(e(We),{key:0})):$("",!0)],64))),64))]),_:1})]),_:2},1040,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:1}),G.value?(g(),A("span",Xe," Código inválido. Por favor, tente novamente. ")):$("",!0),L.value?(g(),A("span",Ye," Novo código enviado com sucesso! ")):$("",!0),w.value>0?(g(),A("span",es," Você pode solicitar um novo código em "+se(w.value)+" segundos. ",1)):(g(),T(e(D),{key:3,type:"button",class:"mt-3",disabled:w.value>0,onClick:pe},{default:r(()=>[j(" Reenviar código ")]),_:1},8,["disabled"]))])],2),t("div",{class:x(["grid gap-6 w-full max-w-[350px]",{hidden:i.value!==3}])},[ss,t("div",ts,[a(e(P),{name:"username",label:"apelido"},{default:r(({componentField:m})=>[a(e(I),{class:"w-full"},{default:r(()=>[a(e(V),null,{default:r(()=>[a(e(H),k({type:"text",class:{"border-2 border-red-500":!e(c)("username")},id:"username"},m,{modelValue:e(s).registerForm.username,"onUpdate:modelValue":l[3]||(l[3]=p=>e(s).registerForm.username=p)}),null,16,["class","modelValue"])]),_:2},1024),a(e(W),{class:"text-red-500"})]),_:2},1024)]),_:1})])],2),t("div",{class:x(["grid gap-6 w-full max-w-[350px]",{hidden:i.value!==4}])},[as,t("div",rs,[a(e(P),{name:"password",label:"senha"},{default:r(({componentField:m})=>[a(e(I),{class:"w-full"},{default:r(()=>[a(e(V),null,{default:r(()=>[a(e(H),k({type:"password",class:["border-2 border-transparent",{"!border-red-500":!X.value||y.value===0,"!border-orange-500":y.value===1,"!border-yellow-500":y.value===2,"!border-green-500":y.value>=3}],id:"password"},m,{modelValue:e(s).registerForm.password,"onUpdate:modelValue":l[4]||(l[4]=p=>e(s).registerForm.password=p)}),null,16,["class","modelValue"])]),_:2},1024),a(e(te),{for:"password",class:x(["text-sm",{"text-red-500":y.value===0,"text-orange-500":y.value===1,"text-yellow-500":y.value===2,"text-green-500":y.value>=3}])},{default:r(()=>[j(se(de.value),1)]),_:1},8,["class"]),t("div",os,[t("div",ls,[t("div",{class:x(["w-4 h-4 bg-red-500 rounded-full",{"!bg-green-500":J.value}])},null,2),ns]),t("div",is,[t("div",{class:x(["w-4 h-4 bg-red-500 rounded-full",{"!bg-green-500":K.value}])},null,2),ds]),t("div",cs,[t("div",{class:x(["flex-shrink-0 w-4 h-4 bg-red-500 rounded-full",{"!bg-green-500":Q.value}])},null,2),us])])]),_:2},1024)]),_:1}),a(e(P),{name:"password-confirm"},{default:r(({componentField:m})=>[a(e(I),{class:"w-full"},{default:r(()=>[a(e(V),null,{default:r(()=>[a(e(te),{for:"password-confirm",class:"text-sm font-semibold"},{default:r(()=>[j(" Confirme a senha: ")]),_:1}),a(e(H),k({type:"password",class:["border-2 border-transparent",{"!border-red-500":!U.value,"border-green-500":U.value}],id:"password-confirm"},m,{modelValue:B.value,"onUpdate:modelValue":l[5]||(l[5]=p=>B.value=p)}),null,16,["class","modelValue"])]),_:2},1024)]),_:2},1024)]),_:1})])],2),t("div",{class:x(["grid gap-6 w-full max-w-[350px]",{hidden:i.value!==5}])},ps,2),t("div",{class:x(["grid gap-6 w-full max-w-[350px]",{hidden:i.value!==6}])},[fs,t("div",gs,[a(e(P),{name:"recaptcha",label:"ReCAPTCHA"},{default:r(()=>[a(e(I),{class:"flex flex-col items-center justify-center w-full"},{default:r(()=>[a(e(V),null,{default:r(()=>[a(e(Ae),{onWidgetId:ge,onErrorCallback:ve,onExpiredCallback:he,onLoadCallback:xe})]),_:1}),a(e(W),{class:"text-red-500"})]),_:1})]),_:1})])],2),t("div",vs,[a(e(D),{type:"button",variant:"white",class:x(["my-6 rounded-full w-16 h-16 disabled:bg-muted",{hidden:i.value===1}]),onClick:ue},{default:r(()=>[hs]),_:1},8,["class"]),a(e(D),{type:"submit",class:"my-6 rounded-full w-16 h-16 disabled:bg-muted",disabled:!Y.value},{default:r(()=>[xs]),_:1},8,["disabled"])]),t("div",{class:"mt-4 text-sm text-center md:block"},[t("button",{type:"button",class:"text-[#d835fc] underline hover:no-underline",variant:"link",onClick:_e}," Já é um membro? ")])],32))}});export{As as default};
