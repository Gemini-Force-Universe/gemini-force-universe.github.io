import{h as se,i as te,u as s,j as ae,k as re,l as oe,m as le,n as ne,d as de,p as ie,r as T,q as ce,a as f,s as ue,c as W,e,t as fe,f as t,v as pe,x as p,y as k,z as L,w as o,A as me,o as N,B as $,F as V,C as ge}from"./index-pTNjcZjp.js";import{_ as ve}from"./vuedotjs-fG6m_GpH.js";import{r as he,_ as H,a as j,b as B,c as we,z as _e}from"./FormMessage.vue_vue_type_script_setup_true_lang-DRt1eSRi.js";import{_ as D,a as E}from"./Input.vue_vue_type_script_setup_true_lang-jLdNSdpc.js";import{c as G}from"./utils-DnNDQBbQ.js";import{S as xe}from"./Spinner-MXSLBe5O.js";import{u as be}from"./auth-DCUkzX9t.js";import"./index-B58lrkWd.js";function ye(i){return se()?(te(i),!0):!1}function O(i){return typeof i=="function"?i():s(i)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const z=new WeakMap;function q(i,h,a={}){const{mode:A="replace",route:v=ae(),router:m=re(),transform:x=c=>c}=a;z.has(m)||z.set(m,new Map);const r=z.get(m);let l=v.query[i];ye(()=>{l=void 0});let b;const F=oe((c,y)=>(b=y,{get(){return c(),x(l!==void 0?l:O(h))},set(u){l!==u&&(l=u===h||u===null?void 0:u,r.set(i,u===h||u===null?void 0:u),y(),ne(()=>{if(r.size===0)return;const n=Object.fromEntries(r.entries());r.clear();const{params:R,query:C,hash:S}=v;m[O(A)]({params:R,query:{...C,...n},hash:S})}))}}));return le(()=>v.query[i],c=>{l!==c&&(l=c,b())},{flush:"sync"}),F}const Ce={key:0,class:"z-50 absolute left-0 top-0 flex items-center justify-center w-full h-full bg-background/80 backdrop-blur-sm"},Se={class:"grid gap-2 text-center"},ke=e("h1",{class:"text-2xl font-bold"},"Redefinir Senha",-1),Ae={class:"text-sm text-balance text-muted-foreground"},Fe=e("br",null,null,-1),Re={class:"flex flex-col items-center justify-center gap-8"},Pe={class:"flex flex-col gap-2 text-xs"},Te={class:"flex items-start gap-2"},Ve=e("span",null,'A senha deve ser ao menos "razoável".',-1),He={class:"flex items-start gap-2"},je=e("span",null,"Deve ter no mínimo 8 caracteres.",-1),ze={class:"flex items-start gap-2"},qe=e("span",null," Deve ter ao menos dois dos seguintes itens: letra, número, símbolo. ",-1),Me=e("div",{class:"grid gap-2 text-center"},[e("h1",{class:"text-2xl font-bold"},"Calma lá..."),e("p",{class:"text-sm text-muted-foreground"}," Robôs não são bem-vindos por aqui. (Só ciber-humanos!) ")],-1),Ie={class:"flex flex-col items-center justify-center gap-4"},We={class:"flex items-center justify-center gap-6 w-full"},Le=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[e("path",{"fill-rule":"evenodd",d:"M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})],-1),Ne=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[e("path",{fillRule:"evenodd",d:"M12.97 3.97a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06l6.22-6.22H3a.75.75 0 0 1 0-1.5h16.19l-6.22-6.22a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})],-1),$e=me('<div class="absolute bottom-5 flex items-center flex-col w-full"><div class="flex items-center gap-8 text-xs"><a href="/documents/gfu_servico.pdf" target="_blank" class="text-muted-foreground underline hover:no-underline"> Termos de Serviço </a><a href="/documents/gfu_privacidade.pdf" target="_blank" class="text-muted-foreground underline hover:no-underline"> Política de Privacidade </a></div><div class="flex items-center justify-between px-5 mt-5 text-xs w-full"><span class="text-muted-foreground"> © 2024 Gemini Force Universe </span><span class="text-muted-foreground"> Feito com ❤️ e <a class="ml-[2px]" href="https://vuejs.org" target="_blank" title="Vue.js"><img src="'+ve+'" class="size-[14px] inline-block"></a></span></div></div>',1),Be=e("div",{class:"col-span-5 flex items-start justify-end my-auto w-full h-1/4 lg:h-full"},[e("div",{class:"mr-8 h-[15%] aspect-square bg-center bg-cover",style:{"background-image":"url(/images/gfu_logo.png)"}})],-1),Ke=de({__name:"PasswordResetView",setup(i){const h=["Muito fraca","Fraca","Razoável","Forte","Muito forte"],a=be(),{handleSubmit:A,isFieldValid:v,setFieldValue:m}=ie({initialValues:{password:a.registerForm.password,recaptcha:""},validationSchema:he}),x=T(null),r=T(1),l=T(""),b=q("code"),F=q("email"),c=q("user"),{focused:y}=ce(x),u=f(()=>a.registerForm.isLoading),n=f(()=>a.registerForm.password===""?0:_e(a.registerForm.password).score),R=f(()=>h[n.value]),C=f(()=>n.value>=2),S=f(()=>a.registerForm.password.length>=8),M=f(()=>{const d=a.registerForm.password,g=/[a-zA-Z]/.test(d),w=/[0-9]/.test(d),_=/[^a-zA-Z0-9]/.test(d);return[g,w,_].filter(Boolean).length>=2}),I=f(()=>v("password")&&C&&S.value&&M.value),P=f(()=>l.value!==""&&l.value===a.registerForm.password),Z=f(()=>r.value===1?I.value&&P.value:r.value===2?v("recaptcha"):!1),Q=()=>{r.value-=1},U=()=>{r.value===1?r.value+=1:J()},J=()=>{A(async d=>{await a.resetPassword(b.value,c.value,F.value,d.password,d.recaptcha)?(console.log("Password reset successful."),window.location.href="/"):alert("Ocorreu um erro ao redefinir a senha. Tente novamente mais tarde.")})()},K=d=>{console.log("ReCAPTCHA widget ID:",d)},X=()=>{console.error("ReCAPTCHA widget error."),m("recaptcha","")},Y=()=>{console.log("ReCAPTCHA widget expired."),m("recaptcha","")},ee=d=>{console.log("ReCAPTCHA widget response received."),m("recaptcha",d)};return ue(()=>{a.registerForm.isLoading=!1,setTimeout(()=>{y.value=!0},100)}),(d,g)=>(N(),W("div",{class:p(s(G)("flex flex-col-reverse items-center justify-center","p-5","w-screen h-screen","bg-background bg-center bg-cover","md:p-20","lg:grid lg:grid-cols-7","lg:p-0")),style:{"background-image":"url(/images/lobby.jpg)"}},[e("div",{class:p(s(G)("col-span-2","relative","flex items-center justify-center","px-8 py-12","rounded-xl","w-full","bg-background/90 backdrop-blur-md","lg:rounded-none","lg:h-full"))},[e("form",{class:"flex flex-col items-center justify-center gap-4 w-full",novalidate:"",onSubmit:fe(U,["prevent"])},[u.value?(N(),W("div",Ce,[t(xe)])):pe("",!0),e("div",{class:p(["grid gap-6 w-full max-w-[350px]",{hidden:r.value!==1}])},[e("div",Se,[ke,e("p",Ae,[k(' Crie uma nova senha para a conta "'+L(s(c))+'".',1),Fe,k("A senha deve ser forte e segura. ")])]),e("div",Re,[t(s(V),{name:"password",label:"senha"},{default:o(({componentField:w})=>[t(s(H),{class:"w-full"},{default:o(()=>[t(s(j),null,{default:o(()=>[t(s(D),$({ref_key:"$passwordInput",ref:x,type:"password",class:["border-2 border-transparent",{"!border-red-500":!I.value||n.value===0,"!border-orange-500":n.value===1,"!border-yellow-500":n.value===2,"!border-green-500":n.value>=3}],id:"password"},w,{modelValue:s(a).registerForm.password,"onUpdate:modelValue":g[0]||(g[0]=_=>s(a).registerForm.password=_)}),null,16,["class","modelValue"])]),_:2},1024),t(s(B),{for:"password",class:p(["text-sm",{"text-red-500":n.value===0,"text-orange-500":n.value===1,"text-yellow-500":n.value===2,"text-green-500":n.value>=3}])},{default:o(()=>[k(L(R.value),1)]),_:1},8,["class"]),e("div",Pe,[e("div",Te,[e("div",{class:p(["w-4 h-4 bg-red-500 rounded-full",{"!bg-green-500":C.value}])},null,2),Ve]),e("div",He,[e("div",{class:p(["w-4 h-4 bg-red-500 rounded-full",{"!bg-green-500":S.value}])},null,2),je]),e("div",ze,[e("div",{class:p(["flex-shrink-0 w-4 h-4 bg-red-500 rounded-full",{"!bg-green-500":M.value}])},null,2),qe])])]),_:2},1024)]),_:1}),t(s(V),{name:"password-confirm"},{default:o(({componentField:w})=>[t(s(H),{class:"w-full"},{default:o(()=>[t(s(j),null,{default:o(()=>[t(s(B),{for:"password-confirm",class:"text-sm font-semibold"},{default:o(()=>[k(" Confirme a senha: ")]),_:1}),t(s(D),$({type:"password",class:["border-2 border-transparent",{"!border-red-500":!P.value,"border-green-500":P.value}],id:"password-confirm"},w,{modelValue:l.value,"onUpdate:modelValue":g[1]||(g[1]=_=>l.value=_)}),null,16,["class","modelValue"])]),_:2},1024)]),_:2},1024)]),_:1})])],2),e("div",{class:p(["grid gap-6 w-full max-w-[350px]",{hidden:r.value!==2}])},[Me,e("div",Ie,[t(s(V),{name:"recaptcha",label:"ReCAPTCHA"},{default:o(()=>[t(s(H),{class:"flex flex-col items-center justify-center w-full"},{default:o(()=>[t(s(j),null,{default:o(()=>[t(s(ge),{onWidgetId:K,onErrorCallback:X,onExpiredCallback:Y,onLoadCallback:ee})]),_:1}),t(s(we),{class:"text-red-500"})]),_:1})]),_:1})])],2),e("div",We,[t(s(E),{type:"button",variant:"white",class:p(["my-6 rounded-full w-16 h-16 disabled:bg-muted",{hidden:r.value===1}]),onClick:Q},{default:o(()=>[Le]),_:1},8,["class"]),t(s(E),{type:"submit",class:"my-6 rounded-full w-16 h-16 disabled:bg-muted",disabled:!Z.value},{default:o(()=>[Ne]),_:1},8,["disabled"])])],32),$e],2),Be],2))}});export{Ke as default};
